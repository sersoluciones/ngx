import { __decorate } from "tslib";
import { Injectable } from '@angular/core';
import { Observable } from 'rxjs';
import * as i0 from "@angular/core";
let MapService = class MapService {
    /**
     * Metodo para obtener la posisión GPS actual usando Observable
     * @example
     * this.mapService.getCurrentPosition().pipe(take(1)).subscribe({
     *      next(position) {
     *        console.log('Current Position: ', position);
     *      },
     *      error(msg) {
     *        console.log('Error Getting Location: ', msg);
     *      }
     *   });
     */
    getCurrentPosition() {
        return new Observable((observer) => {
            // Simple geolocation API check provides values to publish
            if ('geolocation' in navigator) {
                navigator.geolocation.getCurrentPosition((position) => {
                    observer.next(position);
                }, (error) => {
                    observer.error(error);
                });
            }
            else {
                observer.error('Geolocation not available');
            }
        });
    }
    /**
     * Verifica si la latitud y longitud son válidas
     * @param lat Latitud
     * @param lng Longitud
     */
    checkLatLog(lat, lng) {
        return (-90 <= lat) && (90 >= lat) && (-180 <= lng) && (180 >= lng);
    }
    /**
     * Obtiene la distancia en km entre dos puntos LatLng
     * @param lon1 Latitud
     */
    distancePoints(options) {
        // tslint:disable-next-line: max-line-length
        const a = Math.sin(((options.to.lat - options.from.lat) * Math.PI / 180) / 2) * Math.sin(((options.to.lat - options.from.lat) * Math.PI / 180) / 2) + Math.cos(options.from.lat * Math.PI / 180) * Math.cos(options.to.lat * Math.PI / 180) * Math.sin(((options.to.lng - options.from.lng) * Math.PI / 180) / 2) * Math.sin(((options.to.lng - options.from.lng) * Math.PI / 180) / 2);
        return (6371 * (2 * Math.asin(Math.sqrt(a)))) * 1.60934;
    }
    cutPrecision(obj, precision) {
        if ('number' === typeof obj[0]) {
            for (let i = 0; i < obj.length; i++) {
                obj[i] = Math.round(obj[i] * precision) / precision;
            }
        }
        else {
            const arr = obj.features || obj.geometries || obj.coordinates || obj;
            for (let i = 0; i < arr.length; i++) {
                this.cutPrecision(arr[i], precision);
            }
        }
    }
    middlePoint(options) {
        if ((options.from.lng !== options.to.lng) || (options.from.lat !== options.to.lat)) {
            const lat1 = options.from.lat * Math.PI / 180;
            const lat2 = options.to.lat * Math.PI / 180;
            const lon1 = options.from.lng * Math.PI / 180;
            const lon2 = options.to.lng * Math.PI / 180;
            const dLon = lon2 - lon1;
            const x = Math.cos(lat2) * Math.cos(dLon);
            const y = Math.cos(lat2) * Math.sin(dLon);
            let lat3 = Math.atan2(Math.sin(lat1) + Math.sin(lat2), Math.sqrt((Math.cos(lat1) + x) * (Math.cos(lat1) + x) + y * y));
            let lon3 = lon1 + Math.atan2(y, Math.cos(lat1) + x);
            lat3 *= 180 / Math.PI;
            lon3 *= 180 / Math.PI;
            const deltaY = options.to.lng - options.from.lng;
            const deltaX = options.to.lat - options.from.lat;
            const angleInDegrees = Math.atan2(deltaY, deltaX) * 180 / Math.PI;
            return {
                longitude: lon3,
                Latitude: lat3,
                angle: angleInDegrees,
                distance: this.distancePoints(options)
            };
        }
        else {
            return false;
        }
    }
};
MapService.ɵprov = i0.ɵɵdefineInjectable({ factory: function MapService_Factory() { return new MapService(); }, token: MapService, providedIn: "root" });
MapService = __decorate([
    Injectable({
        providedIn: 'root'
    })
], MapService);
export { MapService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFwLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9Ac2Vyc29sL25neC8iLCJzb3VyY2VzIjpbIm1hcC9tYXAuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMzQyxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sTUFBTSxDQUFDOztBQU1sQyxJQUFhLFVBQVUsR0FBdkIsTUFBYSxVQUFVO0lBRW5COzs7Ozs7Ozs7OztPQVdHO0lBQ0gsa0JBQWtCO1FBRWQsT0FBTyxJQUFJLFVBQVUsQ0FBQyxDQUFDLFFBQVEsRUFBRSxFQUFFO1lBRS9CLDBEQUEwRDtZQUMxRCxJQUFJLGFBQWEsSUFBSSxTQUFTLEVBQUU7Z0JBQzVCLFNBQVMsQ0FBQyxXQUFXLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxRQUFrQixFQUFFLEVBQUU7b0JBQzVELFFBQVEsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7Z0JBQzVCLENBQUMsRUFBRSxDQUFDLEtBQW9CLEVBQUUsRUFBRTtvQkFDeEIsUUFBUSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQztnQkFDMUIsQ0FBQyxDQUFDLENBQUM7YUFDTjtpQkFBTTtnQkFDSCxRQUFRLENBQUMsS0FBSyxDQUFDLDJCQUEyQixDQUFDLENBQUM7YUFDL0M7UUFDTCxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFFRDs7OztPQUlHO0lBQ0gsV0FBVyxDQUFDLEdBQVcsRUFBRSxHQUFXO1FBQ2hDLE9BQU8sQ0FBQyxDQUFDLEVBQUUsSUFBSSxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsSUFBSSxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxJQUFJLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLEdBQUcsQ0FBQyxDQUFDO0lBQ3hFLENBQUM7SUFFRDs7O09BR0c7SUFDSCxjQUFjLENBQUMsT0FBNkI7UUFDeEMsNENBQTRDO1FBQzVDLE1BQU0sQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsR0FBRyxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDLEVBQUUsR0FBRyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLEdBQUcsR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxFQUFFLEdBQUcsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsRUFBRSxHQUFHLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDLEVBQUUsR0FBRyxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLEdBQUcsR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxFQUFFLEdBQUcsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUMsRUFBRSxHQUFHLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3hYLE9BQU8sQ0FBQyxJQUFJLEdBQUcsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLE9BQU8sQ0FBQztJQUM1RCxDQUFDO0lBRUQsWUFBWSxDQUFDLEdBQVEsRUFBRSxTQUFpQjtRQUNwQyxJQUFJLFFBQVEsS0FBSyxPQUFPLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRTtZQUM1QixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsR0FBRyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtnQkFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsU0FBUyxDQUFDLEdBQUcsU0FBUyxDQUFDO2FBQUU7U0FDaEc7YUFBTTtZQUNILE1BQU0sR0FBRyxHQUFHLEdBQUcsQ0FBQyxRQUFRLElBQUksR0FBRyxDQUFDLFVBQVUsSUFBSSxHQUFHLENBQUMsV0FBVyxJQUFJLEdBQUcsQ0FBQztZQUNyRSxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsR0FBRyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtnQkFBRSxJQUFJLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxTQUFTLENBQUMsQ0FBQzthQUFFO1NBQ2pGO0lBQ0wsQ0FBQztJQUVELFdBQVcsQ0FBQyxPQUE2QjtRQUVyQyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLEtBQUssT0FBTyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxLQUFLLE9BQU8sQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUU7WUFFaEYsTUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDLEVBQUUsR0FBRyxHQUFHLENBQUM7WUFDOUMsTUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDLEVBQUUsR0FBRyxHQUFHLENBQUM7WUFDNUMsTUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDLEVBQUUsR0FBRyxHQUFHLENBQUM7WUFDOUMsTUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDLEVBQUUsR0FBRyxHQUFHLENBQUM7WUFDNUMsTUFBTSxJQUFJLEdBQUcsSUFBSSxHQUFHLElBQUksQ0FBQztZQUN6QixNQUFNLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDMUMsTUFBTSxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzFDLElBQUksSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUN2SCxJQUFJLElBQUksR0FBRyxJQUFJLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztZQUNwRCxJQUFJLElBQUksR0FBRyxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUM7WUFDdEIsSUFBSSxJQUFJLEdBQUcsR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDO1lBQ3RCLE1BQU0sTUFBTSxHQUFHLE9BQU8sQ0FBQyxFQUFFLENBQUMsR0FBRyxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDO1lBQ2pELE1BQU0sTUFBTSxHQUFHLE9BQU8sQ0FBQyxFQUFFLENBQUMsR0FBRyxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDO1lBQ2pELE1BQU0sY0FBYyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDO1lBQ2xFLE9BQU87Z0JBQ0gsU0FBUyxFQUFFLElBQUk7Z0JBQ2YsUUFBUSxFQUFFLElBQUk7Z0JBQ2QsS0FBSyxFQUFFLGNBQWM7Z0JBQ3JCLFFBQVEsRUFBRSxJQUFJLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQzthQUN6QyxDQUFDO1NBQ0w7YUFBTTtZQUNILE9BQU8sS0FBSyxDQUFDO1NBQ2hCO0lBRUwsQ0FBQztDQUNKLENBQUE7O0FBeEZZLFVBQVU7SUFIdEIsVUFBVSxDQUFDO1FBQ1IsVUFBVSxFQUFFLE1BQU07S0FDckIsQ0FBQztHQUNXLFVBQVUsQ0F3RnRCO1NBeEZZLFVBQVUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgTGF0TG5nMkxhdExuZ09wdGlvbnMgfSBmcm9tICcuL3R5cGVzJztcclxuXHJcbkBJbmplY3RhYmxlKHtcclxuICAgIHByb3ZpZGVkSW46ICdyb290J1xyXG59KVxyXG5leHBvcnQgY2xhc3MgTWFwU2VydmljZSB7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBNZXRvZG8gcGFyYSBvYnRlbmVyIGxhIHBvc2lzacOzbiBHUFMgYWN0dWFsIHVzYW5kbyBPYnNlcnZhYmxlXHJcbiAgICAgKiBAZXhhbXBsZVxyXG4gICAgICogdGhpcy5tYXBTZXJ2aWNlLmdldEN1cnJlbnRQb3NpdGlvbigpLnBpcGUodGFrZSgxKSkuc3Vic2NyaWJlKHtcclxuICAgICAqICAgICAgbmV4dChwb3NpdGlvbikge1xyXG4gICAgICogICAgICAgIGNvbnNvbGUubG9nKCdDdXJyZW50IFBvc2l0aW9uOiAnLCBwb3NpdGlvbik7XHJcbiAgICAgKiAgICAgIH0sXHJcbiAgICAgKiAgICAgIGVycm9yKG1zZykge1xyXG4gICAgICogICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBHZXR0aW5nIExvY2F0aW9uOiAnLCBtc2cpO1xyXG4gICAgICogICAgICB9XHJcbiAgICAgKiAgIH0pO1xyXG4gICAgICovXHJcbiAgICBnZXRDdXJyZW50UG9zaXRpb24oKTogT2JzZXJ2YWJsZTxQb3NpdGlvbj4ge1xyXG5cclxuICAgICAgICByZXR1cm4gbmV3IE9ic2VydmFibGUoKG9ic2VydmVyKSA9PiB7XHJcblxyXG4gICAgICAgICAgICAvLyBTaW1wbGUgZ2VvbG9jYXRpb24gQVBJIGNoZWNrIHByb3ZpZGVzIHZhbHVlcyB0byBwdWJsaXNoXHJcbiAgICAgICAgICAgIGlmICgnZ2VvbG9jYXRpb24nIGluIG5hdmlnYXRvcikge1xyXG4gICAgICAgICAgICAgICAgbmF2aWdhdG9yLmdlb2xvY2F0aW9uLmdldEN1cnJlbnRQb3NpdGlvbigocG9zaXRpb246IFBvc2l0aW9uKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dChwb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICB9LCAoZXJyb3I6IFBvc2l0aW9uRXJyb3IpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG9ic2VydmVyLmVycm9yKCdHZW9sb2NhdGlvbiBub3QgYXZhaWxhYmxlJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFZlcmlmaWNhIHNpIGxhIGxhdGl0dWQgeSBsb25naXR1ZCBzb24gdsOhbGlkYXNcclxuICAgICAqIEBwYXJhbSBsYXQgTGF0aXR1ZFxyXG4gICAgICogQHBhcmFtIGxuZyBMb25naXR1ZFxyXG4gICAgICovXHJcbiAgICBjaGVja0xhdExvZyhsYXQ6IG51bWJlciwgbG5nOiBudW1iZXIpIHtcclxuICAgICAgICByZXR1cm4gKC05MCA8PSBsYXQpICYmICg5MCA+PSBsYXQpICYmICgtMTgwIDw9IGxuZykgJiYgKDE4MCA+PSBsbmcpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogT2J0aWVuZSBsYSBkaXN0YW5jaWEgZW4ga20gZW50cmUgZG9zIHB1bnRvcyBMYXRMbmdcclxuICAgICAqIEBwYXJhbSBsb24xIExhdGl0dWRcclxuICAgICAqL1xyXG4gICAgZGlzdGFuY2VQb2ludHMob3B0aW9uczogTGF0TG5nMkxhdExuZ09wdGlvbnMpIHtcclxuICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6IG1heC1saW5lLWxlbmd0aFxyXG4gICAgICAgIGNvbnN0IGEgPSBNYXRoLnNpbigoKG9wdGlvbnMudG8ubGF0IC0gb3B0aW9ucy5mcm9tLmxhdCkgKiBNYXRoLlBJIC8gMTgwKSAvIDIpICogTWF0aC5zaW4oKChvcHRpb25zLnRvLmxhdCAtIG9wdGlvbnMuZnJvbS5sYXQpICogTWF0aC5QSSAvIDE4MCkgLyAyKSArIE1hdGguY29zKG9wdGlvbnMuZnJvbS5sYXQgKiBNYXRoLlBJIC8gMTgwKSAqIE1hdGguY29zKG9wdGlvbnMudG8ubGF0ICogTWF0aC5QSSAvIDE4MCkgKiBNYXRoLnNpbigoKG9wdGlvbnMudG8ubG5nIC0gb3B0aW9ucy5mcm9tLmxuZykgKiBNYXRoLlBJIC8gMTgwKSAvIDIpICogTWF0aC5zaW4oKChvcHRpb25zLnRvLmxuZyAtIG9wdGlvbnMuZnJvbS5sbmcpICogTWF0aC5QSSAvIDE4MCkgLyAyKTtcclxuICAgICAgICByZXR1cm4gKDYzNzEgKiAoMiAqIE1hdGguYXNpbihNYXRoLnNxcnQoYSkpKSkgKiAxLjYwOTM0O1xyXG4gICAgfVxyXG5cclxuICAgIGN1dFByZWNpc2lvbihvYmo6IGFueSwgcHJlY2lzaW9uOiBudW1iZXIpIHtcclxuICAgICAgICBpZiAoJ251bWJlcicgPT09IHR5cGVvZiBvYmpbMF0pIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvYmoubGVuZ3RoOyBpKyspIHsgb2JqW2ldID0gTWF0aC5yb3VuZChvYmpbaV0gKiBwcmVjaXNpb24pIC8gcHJlY2lzaW9uOyB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgYXJyID0gb2JqLmZlYXR1cmVzIHx8IG9iai5nZW9tZXRyaWVzIHx8IG9iai5jb29yZGluYXRlcyB8fCBvYmo7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7IHRoaXMuY3V0UHJlY2lzaW9uKGFycltpXSwgcHJlY2lzaW9uKTsgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBtaWRkbGVQb2ludChvcHRpb25zOiBMYXRMbmcyTGF0TG5nT3B0aW9ucykge1xyXG5cclxuICAgICAgICBpZiAoKG9wdGlvbnMuZnJvbS5sbmcgIT09IG9wdGlvbnMudG8ubG5nKSB8fCAob3B0aW9ucy5mcm9tLmxhdCAhPT0gb3B0aW9ucy50by5sYXQpKSB7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBsYXQxID0gb3B0aW9ucy5mcm9tLmxhdCAqIE1hdGguUEkgLyAxODA7XHJcbiAgICAgICAgICAgIGNvbnN0IGxhdDIgPSBvcHRpb25zLnRvLmxhdCAqIE1hdGguUEkgLyAxODA7XHJcbiAgICAgICAgICAgIGNvbnN0IGxvbjEgPSBvcHRpb25zLmZyb20ubG5nICogTWF0aC5QSSAvIDE4MDtcclxuICAgICAgICAgICAgY29uc3QgbG9uMiA9IG9wdGlvbnMudG8ubG5nICogTWF0aC5QSSAvIDE4MDtcclxuICAgICAgICAgICAgY29uc3QgZExvbiA9IGxvbjIgLSBsb24xO1xyXG4gICAgICAgICAgICBjb25zdCB4ID0gTWF0aC5jb3MobGF0MikgKiBNYXRoLmNvcyhkTG9uKTtcclxuICAgICAgICAgICAgY29uc3QgeSA9IE1hdGguY29zKGxhdDIpICogTWF0aC5zaW4oZExvbik7XHJcbiAgICAgICAgICAgIGxldCBsYXQzID0gTWF0aC5hdGFuMihNYXRoLnNpbihsYXQxKSArIE1hdGguc2luKGxhdDIpLCBNYXRoLnNxcnQoKE1hdGguY29zKGxhdDEpICsgeCkgKiAoTWF0aC5jb3MobGF0MSkgKyB4KSArIHkgKiB5KSk7XHJcbiAgICAgICAgICAgIGxldCBsb24zID0gbG9uMSArIE1hdGguYXRhbjIoeSwgTWF0aC5jb3MobGF0MSkgKyB4KTtcclxuICAgICAgICAgICAgbGF0MyAqPSAxODAgLyBNYXRoLlBJO1xyXG4gICAgICAgICAgICBsb24zICo9IDE4MCAvIE1hdGguUEk7XHJcbiAgICAgICAgICAgIGNvbnN0IGRlbHRhWSA9IG9wdGlvbnMudG8ubG5nIC0gb3B0aW9ucy5mcm9tLmxuZztcclxuICAgICAgICAgICAgY29uc3QgZGVsdGFYID0gb3B0aW9ucy50by5sYXQgLSBvcHRpb25zLmZyb20ubGF0O1xyXG4gICAgICAgICAgICBjb25zdCBhbmdsZUluRGVncmVlcyA9IE1hdGguYXRhbjIoZGVsdGFZLCBkZWx0YVgpICogMTgwIC8gTWF0aC5QSTtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGxvbmdpdHVkZTogbG9uMyxcclxuICAgICAgICAgICAgICAgIExhdGl0dWRlOiBsYXQzLFxyXG4gICAgICAgICAgICAgICAgYW5nbGU6IGFuZ2xlSW5EZWdyZWVzLFxyXG4gICAgICAgICAgICAgICAgZGlzdGFuY2U6IHRoaXMuZGlzdGFuY2VQb2ludHMob3B0aW9ucylcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxufVxyXG4iXX0=